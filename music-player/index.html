<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Music Player</title>
<style>
  :root{--card:#0f1113;--muted:#bbb;--accent:#1ed760}
  html,body{height:100%;margin:0}
  body{
    display:flex;
    align-items:center;
    justify-content:center;
    background:linear-gradient(135deg,#0f2a2f,#2b4b50);
    font-family:Inter,Arial,Helvetica,sans-serif;
    color:#fff;
  }

  .player{
    width:420px;
    background:linear-gradient(180deg, rgba(0,0,0,0.7), rgba(0,0,0,0.85));
    padding:22px;
    border-radius:18px;
    box-shadow:0 15px 40px rgba(0,0,0,0.6), 0 6px 12px rgba(0,0,0,0.4);
  }

  .now-playing{
    text-align:center;
    margin-bottom:10px;
  }
  #song-title{font-size:20px; font-weight:700; color:var(--accent); margin:0}
  #song-artist{font-size:14px; color:#ddd; margin:6px 0 0; font-style:italic}

  .progress-wrapper{
    display:flex;
    align-items:center;
    gap:12px;
    margin:16px 0 10px;
  }
  #current-time,#duration{width:40px;font-size:12px;color:var(--muted)}
  #progress{flex:1; appearance:none; height:10px; border-radius:6px; background:#333; outline:none}
  /* progress thumb */
  #progress::-webkit-slider-thumb{ -webkit-appearance:none; width:14px; height:14px; border-radius:50%; background:var(--accent); box-shadow:0 0 0 6px rgba(30,215,96,0.12)}
  #progress::-moz-range-thumb{ width:14px; height:14px; border-radius:50%; background:var(--accent) }

  .controls{ display:flex; justify-content:center; gap:28px; margin-bottom:12px }
  .controls button{
    background:#0b1220; border:0; color:#fff; width:48px; height:48px; border-radius:50%;
    font-size:18px; cursor:pointer; display:inline-grid; place-items:center;
    box-shadow:0 6px 18px rgba(0,0,0,0.6);
  }
  .controls button:hover{ transform:translateY(-2px) }

  .volume-row{ display:flex; align-items:center; gap:10px; justify-content:center; margin-bottom:14px }
  .volume-row label{ font-size:13px; color:var(--muted) }
  #volume{ width:140px; height:8px; background:#333; border-radius:8px; appearance:none }
  #volume::-webkit-slider-thumb{ -webkit-appearance:none; width:12px; height:12px; border-radius:50%; background:#4aa; box-shadow:0 0 0 4px rgba(74,170,255,0.08) }

  .section{ background:rgba(255,255,255,0.03); padding:12px; border-radius:10px; margin-bottom:12px }
  .section h4{ margin:0 0 8px; font-size:14px; text-align:center; color:#eee; }
  ul{ list-style:none; margin:0; padding:0; max-height:140px; overflow:auto }
  li{ display:flex; align-items:center; justify-content:space-between; gap:8px; padding:8px; border-radius:8px; margin-bottom:8px; background:rgba(255,255,255,0.01) }
  li .title{ font-size:13px; color:#fff}
  li .artist{ font-size:11px; color:var(--muted); margin-left:8px }
  .btn{ border:0; padding:6px 8px; border-radius:6px; cursor:pointer; font-weight:600 }
  .add-btn{ background:var(--accent); color:#081; }
  .add-btn:hover{ filter:brightness(.95) }
  .remove-btn{ background:#ff4d4d; color:#fff }
  .clear-btn{ width:100%; background:#ff5c5c; color:#fff; border:0; padding:10px; border-radius:8px; font-weight:700; cursor:pointer }

  /* small screens */
  @media (max-width:460px){
    .player{ width:92vw; padding:16px }
    #progress::-webkit-slider-thumb{ width:12px;height:12px }
  }
</style>
</head>
<body>

  <div class="player">
    <audio id="audio"></audio>

    <div class="now-playing">
      <div id="song-title">Song Title</div>
      <div id="song-artist">Artist Name</div>
    </div>

    <div class="progress-wrapper">
      <div id="current-time">0:00</div>
      <input id="progress" type="range" min="0" max="100" value="0">
      <div id="duration">0:00</div>
    </div>

    <div class="controls" role="group" aria-label="player controls">
      <button id="prev" title="Previous">‚èÆÔ∏è</button>
      <button id="play" title="Play/Pause">‚ñ∂Ô∏è</button>
      <button id="next" title="Next">‚è≠Ô∏è</button>
    </div>

    <div class="volume-row">
      <label for="volume">Volume</label>
      <input id="volume" type="range" min="0" max="1" step="0.01" value="1">
    </div>

    <div class="section all-songs-section">
      <h4>All Songs</h4>
      <ul id="all-songs"></ul>
    </div>

    <div class="section playlist-section">
      <h4>Your Playlist</h4>
      <ul id="playlist"></ul>
      <button id="clear-playlist" class="clear-btn">üóëÔ∏è Clear Playlist</button>
    </div>
  </div>

<script>
(() => {
  // songs (royalty-free sample tracks)
  const songs = [
    { title: "Acoustic Breeze", artist: "Benjamin Tissot", src: "https://www.bensound.com/bensound-music/bensound-acousticbreeze.mp3" },
    { title: "Sunny", artist: "Benjamin Tissot", src: "https://www.bensound.com/bensound-music/bensound-sunny.mp3" },
    { title: "Creative Minds", artist: "Benjamin Tissot", src: "https://www.bensound.com/bensound-music/bensound-creativeminds.mp3" },
    { title: "Energy", artist: "Benjamin Tissot", src: "https://www.bensound.com/bensound-music/bensound-energy.mp3" },
    { title: "Dubstep", artist: "Benjamin Tissot", src: "https://www.bensound.com/bensound-music/bensound-dubstep.mp3" },
    { title: "Dreams", artist: "Benjamin Tissot", src: "https://www.bensound.com/bensound-music/bensound-dreams.mp3" }
  ];

  let currentSongIndex = 0;
  let userPlaylist = [];

  const audio = document.getElementById('audio');
  const playBtn = document.getElementById('play');
  const prevBtn = document.getElementById('prev');
  const nextBtn = document.getElementById('next');
  const titleEl = document.getElementById('song-title');
  const artistEl = document.getElementById('song-artist');
  const progress = document.getElementById('progress');
  const currentTimeEl = document.getElementById('current-time');
  const durationEl = document.getElementById('duration');
  const volumeEl = document.getElementById('volume');
  const allSongsEl = document.getElementById('all-songs');
  const playlistEl = document.getElementById('playlist');
  const clearBtn = document.getElementById('clear-playlist');

  // load song to audio element and update UI (Now Playing)
  function loadSong(index) {
    const s = songs[index];
    if(!s) return;
    audio.src = s.src;
    audio.load(); // ensure metadata loads
    titleEl.textContent = s.title;
    artistEl.textContent = s.artist;
    // update now playing (no separate element - title/artist shown above)
    // reset progress UI until metadata is loaded
    progress.value = 0;
    currentTimeEl.textContent = "0:00";
    durationEl.textContent = "0:00";
  }

  // play with promise handling (autoplay policies)
  async function playSong() {
    try {
      await audio.play();
      playBtn.textContent = "‚è∏Ô∏è";
    } catch(err) {
      // If browser blocks, show hint (user must interact)
      console.warn("Play failed:", err);
      alert("Playback blocked by browser. Click Play again to start the audio.");
    }
  }
  function pauseSong() {
    audio.pause();
    playBtn.textContent = "‚ñ∂Ô∏è";
  }

  playBtn.addEventListener('click', () => {
    if(audio.paused) playSong();
    else pauseSong();
  });

  prevBtn.addEventListener('click', () => {
    // if userPlaylist has items, navigate those; otherwise use global songs
    const pool = userPlaylist.length ? userPlaylist : songs;
    // find index in pool
    let idx = pool.indexOf(songs[currentSongIndex]) !== -1 ? pool.indexOf(songs[currentSongIndex]) : -1;
    if(idx === -1) {
      // fallback: move in global songs
      currentSongIndex = (currentSongIndex - 1 + songs.length) % songs.length;
    } else {
      // previous in user playlist maps to song in songs array
      idx = (idx - 1 + pool.length) % pool.length;
      currentSongIndex = songs.indexOf(pool[idx]);
    }
    loadSong(currentSongIndex);
    playSong();
    updatePlaylistDisplay(); // to reflect active state
  });

  nextBtn.addEventListener('click', () => {
    const pool = userPlaylist.length ? userPlaylist : songs;
    let idx = pool.indexOf(songs[currentSongIndex]) !== -1 ? pool.indexOf(songs[currentSongIndex]) : -1;
    if(idx === -1) {
      currentSongIndex = (currentSongIndex + 1) % songs.length;
    } else {
      idx = (idx + 1) % pool.length;
      currentSongIndex = songs.indexOf(pool[idx]);
    }
    loadSong(currentSongIndex);
    playSong();
    updatePlaylistDisplay();
  });

  // Update progress UI while playing
  function updateProgressUI() {
    if(!audio.duration || isNaN(audio.duration)) return;
    const pct = (audio.currentTime / audio.duration) * 100;
    progress.value = pct || 0;

    const cm = Math.floor(audio.currentTime/60);
    const cs = Math.floor(audio.currentTime%60).toString().padStart(2,'0');
    const dm = Math.floor(audio.duration/60);
    const ds = Math.floor(audio.duration%60).toString().padStart(2,'0');

    currentTimeEl.textContent = `${cm}:${cs}`;
    durationEl.textContent = `${dm}:${ds}`;
  }

  audio.addEventListener('timeupdate', updateProgressUI);

  // When metadata available, show duration immediately
  audio.addEventListener('loadedmetadata', updateProgressUI);

  // Seek when user interacts with progress bar
  progress.addEventListener('input', () => {
    if(audio.duration && !isNaN(audio.duration)) {
      audio.currentTime = (progress.value/100) * audio.duration;
      updateProgressUI();
    }
  });

  // Volume
  volumeEl.addEventListener('input', () => {
    audio.volume = parseFloat(volumeEl.value);
  });

  // Display all songs list
  function displayAllSongs() {
    allSongsEl.innerHTML = "";
    songs.forEach((s, idx) => {
      const li = document.createElement('li');
      const titleWrap = document.createElement('div');
      titleWrap.style.display = 'flex';
      titleWrap.style.flexDirection = 'column';
      const tspan = document.createElement('span');
      tspan.textContent = s.title;
      tspan.className = 'title';
      const aspan = document.createElement('span');
      aspan.textContent = s.artist;
      aspan.className = 'artist';
      titleWrap.appendChild(tspan);
      titleWrap.appendChild(aspan);

      const addBtn = document.createElement('button');
      addBtn.textContent = '‚ûï Add';
      addBtn.className = 'btn add-btn';
      addBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        if(!userPlaylist.includes(s)) {
          userPlaylist.push(s);
          updatePlaylistDisplay();
        } else {
          // optionally give feedback
          alert("Song already in your playlist.");
        }
      });

      // click on title plays the song immediately (does not add)
      titleWrap.addEventListener('click', () => {
        currentSongIndex = idx;
        loadSong(currentSongIndex);
        playSong();
        updatePlaylistDisplay();
      });

      li.appendChild(titleWrap);
      li.appendChild(addBtn);
      allSongsEl.appendChild(li);
    });
  }

  // Update user's playlist UI
  function updatePlaylistDisplay() {
    playlistEl.innerHTML = "";
    userPlaylist.forEach((s, i) => {
      const li = document.createElement('li');
      const left = document.createElement('div');
      left.style.display = 'flex';
      left.style.flexDirection = 'column';
      const t = document.createElement('span');
      t.textContent = s.title; t.className='title';
      const a = document.createElement('span');
      a.textContent = s.artist; a.className='artist';
      left.appendChild(t); left.appendChild(a);

      const right = document.createElement('div');
      right.style.display='flex'; right.style.gap='8px';
      const playNowBtn = document.createElement('button');
      playNowBtn.textContent = '‚ñ∂';
      playNowBtn.className = 'btn';
      playNowBtn.title = 'Play this';
      playNowBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        currentSongIndex = songs.indexOf(s);
        loadSong(currentSongIndex);
        playSong();
        updatePlaylistDisplay();
      });

      const remBtn = document.createElement('button');
      remBtn.textContent = '‚ùå';
      remBtn.className = 'btn remove-btn';
      remBtn.title = 'Remove';
      remBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        userPlaylist.splice(i,1);
        updatePlaylistDisplay();
      });

      right.appendChild(playNowBtn);
      right.appendChild(remBtn);

      li.appendChild(left);
      li.appendChild(right);

      // highlight currently playing
      const isPlayingSong = (songs[currentSongIndex] === s) && !audio.paused;
      if(isPlayingSong) {
        li.style.background = "linear-gradient(90deg, rgba(30,215,96,0.12), rgba(30,215,96,0.02))";
      }

      // clicking anywhere plays
      li.addEventListener('click', () => {
        currentSongIndex = songs.indexOf(s);
        loadSong(currentSongIndex);
        playSong();
        updatePlaylistDisplay();
      });

      playlistEl.appendChild(li);
    });
  }

  // Clear playlist
  clearBtn.addEventListener('click', () => {
    userPlaylist = [];
    updatePlaylistDisplay();
  });

  // When song ends -> next
  audio.addEventListener('ended', () => {
    // if userPlaylist exists, move within it; otherwise global list
    const pool = userPlaylist.length ? userPlaylist : songs;
    const curSong = songs[currentSongIndex];
    let idx = pool.indexOf(curSong);
    // if curSong not in pool (e.g. global list used), use global index
    if(idx === -1) {
      // global next
      currentSongIndex = (currentSongIndex + 1) % songs.length;
    } else {
      idx = (idx + 1) % pool.length;
      currentSongIndex = songs.indexOf(pool[idx]);
    }
    loadSong(currentSongIndex);
    playSong();
    updatePlaylistDisplay();
  });

  // Initial startup
  loadSong(currentSongIndex);
  displayAllSongs();
  updatePlaylistDisplay();
  audio.volume = parseFloat(volumeEl.value);

})();
</script>

</body>
</html>

